<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Grant Emerson"/><link rel="canonical" href="http://www.grantemerson.co/blog/SwiftMoji26"/><meta name="twitter:url" content="http://www.grantemerson.co/blog/SwiftMoji26"/><meta name="og:url" content="http://www.grantemerson.co/blog/SwiftMoji26"/><title>Powerful Predicates | Grant Emerson</title><meta name="twitter:title" content="Powerful Predicates | Grant Emerson"/><meta name="og:title" content="Powerful Predicates | Grant Emerson"/><meta name="description" content="SwiftMoji Entry #26"/><meta name="twitter:description" content="SwiftMoji Entry #26"/><meta name="og:description" content="SwiftMoji Entry #26"/><meta name="twitter:card" content="summary_large_image"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/favicon.ico" type="icon"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Grant Emerson"/><meta name="twitter:image" content="http://www.grantemerson.co/ArticleImages/SwiftMoji.jpeg"/><meta name="og:image" content="http://www.grantemerson.co/ArticleImages/SwiftMoji.jpeg"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">Grant Emerson</a><nav><ul><li><a href="/about">About Me</a></li><li><a class="selected" href="/blog">Blog</a></li><li><a href="/projects">Projects</a></li><li><a href="mailto:grantjemerson@gmail.com">Contact</a></li></ul></nav></div></header><div class="wrapper"><article><div class="content"><h1>Powerful Predicates</h1><span class="article-date">Published on Dec 20, 2019</span><div>
    <img class="article-image" src="/ArticleImages/SwiftMoji.jpeg">
    <p class="article-image-description">Powerful Predicates — SwiftMoji Entry #26</p>
</div><p>The <em>Foundation</em> framework exposes a powerful class called <em>NSPredicate</em> for filtering data. An <em>NSPredicate</em> is initialized using a formatting <em>String</em> written in <a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html">Apple’s predicate syntax</a>. The initializer also takes in a variadic argument list of values that can be dynamically inserted into the specified <em>format</em> <em>String</em>. In the code example, a <em>Craft</em> object is created with three properties: <em>name</em>, <em>maxAltitude</em>, and <em>maxSpeed</em>. The class definition is preceded with the <em>@objcMembers</em> attributed which allows the Swift properties to interact with the underlying Objective-C code in the <em>NSPredicate</em> API. The <em>Array</em> of <em>Crafts</em> must be cast to an <em>NSArray</em> to use the <em>filtered(using:)</em> method. The defined <em>predicate</em> filters out any elements of the <em>crafts</em> <em>NSArray</em> which don’t have a <em>name</em> beginning with <em>“Gulfstream”</em> and <em>maxAltitude</em> between <em>25,000</em> and <em>50,000</em> ft. The “<em>%@</em>” is used to substitute an object (in this case a <em>String</em>) from the argument list into the <em>predicate</em>. Additionally, the “<em>%K</em>” can be used to substitute in different key paths. The “<em>[c]</em>” tied to the end of the <em>BEGINSWITH</em> declaration allows the <em>String</em> comparison to be executed without case sensitivity. The predicate syntax is fairly straightforward. It should be easy to adopt with or without a background in querying languages such as SQL. Although Apple seems to be promoting value-based and functional programming alternatives to some of these older OOP APIs, they are still valuable to learn because many frameworks such as <em>Core Data</em> still rely heavily on them.</p><pre><code><span class="keyword">import</span> Foundation

<span class="keyword">@objcMembers class</span> Craft: <span class="type">NSObject</span> {
    <span class="keyword">let</span> name: <span class="type">String</span>
    <span class="keyword">let</span> maxAltitude: <span class="type">Int</span>
    <span class="keyword">let</span> maxSpeed: <span class="type">Int</span>
    
    <span class="keyword">init</span>(name: <span class="type">String</span>, maxAltitude: <span class="type">Int</span>, maxSpeed: <span class="type">Int</span>) {
        <span class="keyword">self</span>.<span class="property">name</span> = name
        <span class="keyword">self</span>.<span class="property">maxAltitude</span> = maxAltitude
        <span class="keyword">self</span>.<span class="property">maxSpeed</span> = maxSpeed
    }
    
    <span class="keyword">override var</span> description: <span class="type">String</span> { name }
}

<span class="keyword">let</span> 🛩 = <span class="type">Craft</span>(name: <span class="string">"Gulfstream G550"</span>, maxAltitude: <span class="number">49500</span>, maxSpeed: <span class="number">585</span>)
<span class="keyword">let</span> 🛬 = <span class="type">Craft</span>(name: <span class="string">"gulfstream g650"</span>, maxAltitude: <span class="number">51000</span>, maxSpeed: <span class="number">610</span>)
<span class="keyword">let</span> 🚀 = <span class="type">Craft</span>(name: <span class="string">"BFR"</span>, maxAltitude: <span class="type">Int</span>.<span class="property">max</span>, maxSpeed: <span class="number">18000</span>)
<span class="keyword">let</span> 🚁 = <span class="type">Craft</span>(name: <span class="string">"Bell 407"</span>, maxAltitude: <span class="number">17618</span>, maxSpeed: <span class="number">162</span>)
<span class="keyword">let</span> crafts = [🛩, 🛬, 🚀, 🚁] <span class="keyword">as</span> <span class="type">NSArray</span>

<span class="keyword">let</span> predicate = <span class="type">NSPredicate</span>(format: <span class="string">"(name BEGINSWITH[c] %@) AND (maxAltitude BETWEEN { 25000, 50000 })"</span>, <span class="string">"Gulfstream"</span>)
<span class="keyword">let</span> listings = crafts.<span class="call">filtered</span>(using: predicate)
<span class="call">print</span>(listings) <span class="comment">// [Gulfstream G550]</span>
</code></pre><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/swiftmoji">SwiftMoji</a></li><li><a href="/tags/swift">Swift</a></li></ul></div></article></div><footer><p>Built using <a href="https://github.com/apple/swift">Swift</a> and <a href="https://github.com/johnsundell/publish">Publish</a>.</p><p>© 2023 Grant Emerson</p><p><a href="/feed.rss">RSS</a> | <a href="mailto:grantjemerson@gmail.com">Email</a></p></footer></body></html>